'use strict';const _0x3595ed=_0x2567;(function(_0x61ace6,_0x2677f1){const _0x3e938e=_0x2567,_0x542a69=_0x61ace6();while(!![]){try{const _0x536e7a=parseInt(_0x3e938e(0x1a2))/0x1+parseInt(_0x3e938e(0x187))/0x2+parseInt(_0x3e938e(0x1a9))/0x3*(-parseInt(_0x3e938e(0x1c0))/0x4)+-parseInt(_0x3e938e(0x1a6))/0x5*(-parseInt(_0x3e938e(0x190))/0x6)+-parseInt(_0x3e938e(0x1b1))/0x7*(-parseInt(_0x3e938e(0x1b5))/0x8)+-parseInt(_0x3e938e(0x1b2))/0x9+-parseInt(_0x3e938e(0x173))/0xa;if(_0x536e7a===_0x2677f1)break;else _0x542a69['push'](_0x542a69['shift']());}catch(_0x20494){_0x542a69['push'](_0x542a69['shift']());}}}(_0x3c34,0xb6b2f));var __decorate=this&&this['__decorate']||function(_0x415844,_0x72a5d5,_0x45f55d,_0x2ce37){const _0x23afc1=_0x2567;var _0x32b6eb=arguments['length'],_0x12ef5c=_0x32b6eb<0x3?_0x72a5d5:_0x2ce37===null?_0x2ce37=Object[_0x23afc1(0x18d)](_0x72a5d5,_0x45f55d):_0x2ce37,_0x4700ab;if(typeof Reflect===_0x23afc1(0x19c)&&typeof Reflect[_0x23afc1(0x17f)]===_0x23afc1(0x1c1))_0x12ef5c=Reflect[_0x23afc1(0x17f)](_0x415844,_0x72a5d5,_0x45f55d,_0x2ce37);else{for(var _0x196db0=_0x415844[_0x23afc1(0x1c2)]-0x1;_0x196db0>=0x0;_0x196db0--)if(_0x4700ab=_0x415844[_0x196db0])_0x12ef5c=(_0x32b6eb<0x3?_0x4700ab(_0x12ef5c):_0x32b6eb>0x3?_0x4700ab(_0x72a5d5,_0x45f55d,_0x12ef5c):_0x4700ab(_0x72a5d5,_0x45f55d))||_0x12ef5c;}return _0x32b6eb>0x3&&_0x12ef5c&&Object[_0x23afc1(0x195)](_0x72a5d5,_0x45f55d,_0x12ef5c),_0x12ef5c;},__metadata=this&&this[_0x3595ed(0x192)]||function(_0x1d4c15,_0x3d23d1){const _0x202e52=_0x3595ed;if(typeof Reflect===_0x202e52(0x19c)&&typeof Reflect[_0x202e52(0x1ac)]===_0x202e52(0x1c1))return Reflect[_0x202e52(0x1ac)](_0x1d4c15,_0x3d23d1);},__param=this&&this[_0x3595ed(0x185)]||function(_0x2ba51c,_0x253587){return function(_0x247027,_0x2960ad){_0x253587(_0x247027,_0x2960ad,_0x2ba51c);};};Object[_0x3595ed(0x195)](exports,'__esModule',{'value':!![]}),exports[_0x3595ed(0x1b9)]=void 0x0;function _0x3c34(){const _0x30082d=['aotoPlay','bindWxBySceneStr','genXmlMsgByConfig','eventkey','loginBySceneStr','xml:\x20','公众号静默登录','12014530JNhcSV','获取登录二维码sceneStr','design:paramtypes','Req','@nestjs/swagger','getJsapiTicket','design:type','Body','officialService','ApiTags','prototype','ApiOperation','decorate','Controller','../../common/auth/jwtAuth.guard','getQRCodeTicket','text','notify','__param','./dto/getQrCode.dto','2518284hNhSPo','officialScanLoginText','send','getQRSceneStrByBind','Post','UseGuards','getOwnPropertyDescriptor','log','扫码绑定轮询查询','71388niiFKB','loginByCode','__metadata','sceneStr','echostr','defineProperty','Query','GetQrCodeDto','success','JwtAuthGuard','scanBindWx','获取绑定二维码的sceneStr','object','officialSubscribeText','event','getQRSceneStr','TRUE','officialBindAccountText','537059HXIyez','msgtype','fromusername','verify','185OfgHbd','url','SCAN','153027CftdFY','includes','design:returntype','metadata','scan','sceneStr:\x20','nonce','qrscene_','1837437vhEjVQ','9801036pQCfly','official','OfficialService','40DZwovt','code','timestamp','getQRCode','OfficialController','GetQrSceneStrDto','genXmlMsg','Get','notifyPost','status','getRedirectUrl','40YzdiFZ','function','length','获取登录跳转地址'];_0x3c34=function(){return _0x30082d;};return _0x3c34();}const common_1=require('@nestjs/common'),swagger_1=require(_0x3595ed(0x177)),jwtAuth_guard_1=require(_0x3595ed(0x181)),official_service_1=require('./official.service'),getQrCode_dto_1=require(_0x3595ed(0x186)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');function _0x2567(_0x19b12d,_0x54b585){const _0x3c3457=_0x3c34();return _0x2567=function(_0x25679d,_0x597188){_0x25679d=_0x25679d-0x16b;let _0xb7edac=_0x3c3457[_0x25679d];return _0xb7edac;},_0x2567(_0x19b12d,_0x54b585);}let OfficialController=class OfficialController{constructor(_0x478c6a){const _0x3bd3f4=_0x3595ed;this[_0x3bd3f4(0x17b)]=_0x478c6a;}async[_0x3595ed(0x184)](_0x5c7c3c,_0x215af4,_0x1851cb){const _0x28b7bc=_0x3595ed;console[_0x28b7bc(0x18e)]('get\x20通知>>>',_0x215af4,_0x1851cb);const _0x4d8957=await this[_0x28b7bc(0x17b)][_0x28b7bc(0x1a5)](_0x215af4['signature'],_0x215af4[_0x28b7bc(0x1af)],_0x215af4[_0x28b7bc(0x1b7)]);return _0x4d8957?_0x215af4[_0x28b7bc(0x194)]:'';}async['notifyPost'](_0x5320a7,_0x1c0db0,_0x194864,_0x1a0f6c){const _0x37ad6a=_0x3595ed,{xml:_0x56b53e}=_0x194864;console[_0x37ad6a(0x18e)](_0x37ad6a(0x171),_0x56b53e);if(_0x56b53e[_0x37ad6a(0x1a3)][0x0]==_0x37ad6a(0x19e)){if(_0x56b53e[_0x37ad6a(0x19e)][0x0]=='VIEW'||_0x56b53e['event'][0x0]=='CLICK')return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)]('');if(_0x56b53e['event'][0x0]==_0x37ad6a(0x1a8)){console[_0x37ad6a(0x18e)]('扫码');const _0x3ad791=_0x56b53e[_0x37ad6a(0x16f)][0x0];if(_0x3ad791[_0x37ad6a(0x1aa)]('/')){this[_0x37ad6a(0x17b)][_0x37ad6a(0x19a)](_0x56b53e[_0x37ad6a(0x1a4)][0x0],_0x3ad791);const _0x46de31=await this[_0x37ad6a(0x17b)][_0x37ad6a(0x16e)](_0x56b53e,_0x37ad6a(0x1a1));return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)](_0x46de31);}this[_0x37ad6a(0x17b)][_0x37ad6a(0x1ad)](_0x56b53e[_0x37ad6a(0x1a4)][0x0],_0x3ad791);const _0xb09b30=await this[_0x37ad6a(0x17b)][_0x37ad6a(0x16e)](_0x56b53e,_0x37ad6a(0x188));return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)](_0xb09b30);}if(_0x56b53e[_0x37ad6a(0x19e)][0x0]=='subscribe'){console[_0x37ad6a(0x18e)]('订阅',_0x56b53e[_0x37ad6a(0x16f)][0x0]);const _0x2e7142=_0x56b53e[_0x37ad6a(0x16f)][0x0]['split'](_0x37ad6a(0x1b0))[0x1];console[_0x37ad6a(0x18e)](_0x37ad6a(0x1ae),_0x2e7142);if(!_0x2e7142){const _0x1acc9e=await this[_0x37ad6a(0x17b)][_0x37ad6a(0x16e)](_0x56b53e,_0x37ad6a(0x19d));return _0x1a0f6c['status'](0xc8)[_0x37ad6a(0x189)](_0x1acc9e);}if(_0x2e7142[_0x37ad6a(0x1aa)]('/')){this['officialService'][_0x37ad6a(0x19a)](_0x56b53e[_0x37ad6a(0x1a4)][0x0],_0x2e7142);const _0x139105=await this['officialService'][_0x37ad6a(0x16e)](_0x56b53e,'officialBindAccountText');return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)](_0x139105);}this['officialService'][_0x37ad6a(0x1ad)](_0x56b53e[_0x37ad6a(0x1a4)][0x0],_0x2e7142);const _0x43d2ec=await this[_0x37ad6a(0x17b)][_0x37ad6a(0x16e)](_0x56b53e,_0x37ad6a(0x19d));return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)](_0x43d2ec);}if(_0x56b53e[_0x37ad6a(0x19e)][0x0]=='unsubscribe')return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)['send']('');}if(_0x56b53e[_0x37ad6a(0x1a3)][0x0]==_0x37ad6a(0x183)){console[_0x37ad6a(0x18e)]('客户端发送了文字消息');const _0x8ee990=await this[_0x37ad6a(0x17b)][_0x37ad6a(0x16c)](_0x56b53e['content'][0x0]),_0x51057f=await this['officialService'][_0x37ad6a(0x1bb)](_0x56b53e,_0x8ee990);return _0x1a0f6c[_0x37ad6a(0x1be)](0xc8)[_0x37ad6a(0x189)](_0x51057f);}return _0x37ad6a(0x198);}async[_0x3595ed(0x19f)](_0xeb1f88){const _0xa24cd=_0x3595ed;return this[_0xa24cd(0x17b)]['getQRSceneStr'](_0xeb1f88);}async[_0x3595ed(0x18a)](_0x4c4c13){const _0x27ad2d=_0x3595ed;return this[_0x27ad2d(0x17b)][_0x27ad2d(0x18a)](_0x4c4c13);}async['getQRCode'](_0x34e77b){const _0x1f7049=_0x3595ed;if(process['env']['ISDEV']===_0x1f7049(0x1a0))return'';const _0x2b4d62=await this[_0x1f7049(0x17b)][_0x1f7049(0x182)](_0x34e77b[_0x1f7049(0x193)]);return'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x2b4d62);}async[_0x3595ed(0x170)](_0x2f0aa5,_0x47956c){const _0x18446e=_0x3595ed;return this[_0x18446e(0x17b)][_0x18446e(0x170)](_0x2f0aa5,_0x47956c['sceneStr']);}async[_0x3595ed(0x16d)](_0x4997af,_0x353dc2){const _0x203138=_0x3595ed;return this[_0x203138(0x17b)][_0x203138(0x16d)](_0x4997af,_0x353dc2[_0x203138(0x193)]);}async[_0x3595ed(0x1bf)](_0x3ee7ac){const _0x3fb037=_0x3595ed;return this[_0x3fb037(0x17b)][_0x3fb037(0x1bf)](_0x3ee7ac['url']);}async[_0x3595ed(0x178)](_0x21c802){const _0x28c7a0=_0x3595ed;return this[_0x28c7a0(0x17b)][_0x28c7a0(0x178)](_0x21c802[_0x28c7a0(0x1a7)]);}async['loginByCode'](_0x95e8d4,_0x4cc664){const _0x3120a5=_0x3595ed;return this['officialService'][_0x3120a5(0x191)](_0x95e8d4,_0x4cc664[_0x3120a5(0x1b6)]);}};__decorate([(0x0,common_1[_0x3595ed(0x1bc)])(_0x3595ed(0x184)),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__param(0x1,(0x0,common_1[_0x3595ed(0x196)])()),__param(0x2,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object,Object,Object]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],'notify',null),__decorate([(0x0,common_1['Post'])('notify'),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__param(0x1,(0x0,common_1[_0x3595ed(0x196)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1['Res'])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object,Object,Object,Object]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],_0x3595ed(0x1bd),null),__decorate([(0x0,common_1['Post'])(_0x3595ed(0x19f)),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':_0x3595ed(0x174)}),__param(0x0,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[getQrSceneStr_dto_1[_0x3595ed(0x1ba)]]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x3595ed(0x18b)])(_0x3595ed(0x18a)),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':_0x3595ed(0x19b)}),(0x0,common_1[_0x3595ed(0x18c)])(jwtAuth_guard_1[_0x3595ed(0x199)]),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],_0x3595ed(0x18a),null),__decorate([(0x0,common_1['Get'])(_0x3595ed(0x1b8)),(0x0,swagger_1['ApiOperation'])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x3595ed(0x196)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[getQrCode_dto_1[_0x3595ed(0x197)]]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],_0x3595ed(0x1b8),null),__decorate([(0x0,common_1['Post'])(_0x3595ed(0x170)),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__param(0x1,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object,getQrCode_dto_1[_0x3595ed(0x197)]]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],_0x3595ed(0x170),null),__decorate([(0x0,common_1['Post'])(_0x3595ed(0x16d)),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':_0x3595ed(0x18f)}),(0x0,common_1[_0x3595ed(0x18c)])(jwtAuth_guard_1[_0x3595ed(0x199)]),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__param(0x1,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object,getQrCode_dto_1[_0x3595ed(0x197)]]),__metadata('design:returntype',Promise)],OfficialController[_0x3595ed(0x17d)],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x3595ed(0x18b)])('getRedirectUrl'),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':_0x3595ed(0x16b)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],_0x3595ed(0x1bf),null),__decorate([(0x0,common_1[_0x3595ed(0x18b)])('getJsapiTicket'),(0x0,swagger_1[_0x3595ed(0x17e)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object]),__metadata(_0x3595ed(0x1ab),Promise)],OfficialController[_0x3595ed(0x17d)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x3595ed(0x18b)])(_0x3595ed(0x191)),(0x0,swagger_1['ApiOperation'])({'summary':_0x3595ed(0x172)}),__param(0x0,(0x0,common_1[_0x3595ed(0x176)])()),__param(0x1,(0x0,common_1[_0x3595ed(0x17a)])()),__metadata(_0x3595ed(0x179),Function),__metadata(_0x3595ed(0x175),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x3595ed(0x191),null),OfficialController=__decorate([(0x0,swagger_1[_0x3595ed(0x17c)])(_0x3595ed(0x1b3)),(0x0,common_1[_0x3595ed(0x180)])(_0x3595ed(0x1b3)),__metadata('design:paramtypes',[official_service_1[_0x3595ed(0x1b4)]])],OfficialController),exports['OfficialController']=OfficialController;