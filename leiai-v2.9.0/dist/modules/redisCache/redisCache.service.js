'use strict';function _0x4b78(){const _0xeaca25=['244020fQjhmd','redisClient','__decorate','defineProperty','token:','saveToken','design:paramtypes','2261CFOkcn','UNAUTHORIZED','HttpStatus','get','decorate','Injectable','invalidateTokens','length','188534DvMsGx','Inject','del','test','HttpException','RedisCacheService','forEach','function','zRange','admin','164155ytpggb','super','__param','4630023dObSxL','metadata','您已在其他设备覆盖登录、请您重新登录！','@nestjs/common','ttl','__esModule','expire','253067IHRYiN','getOwnPropertyDescriptor','checkTokenAuth','onModuleInit','__metadata','set','9608HpQwON','892dsbTYv','object','4449HWJPYU','tokens:'];_0x4b78=function(){return _0xeaca25;};return _0x4b78();}const _0x16c536=_0x3b78;(function(_0xae2c8d,_0x26fc8a){const _0x4bb900=_0x3b78,_0x18de53=_0xae2c8d();while(!![]){try{const _0x7d1e1d=-parseInt(_0x4bb900(0x151))/0x1+-parseInt(_0x4bb900(0x13d))/0x2+parseInt(_0x4bb900(0x12c))/0x3*(-parseInt(_0x4bb900(0x12a))/0x4)+-parseInt(_0x4bb900(0x147))/0x5+parseInt(_0x4bb900(0x12e))/0x6+-parseInt(_0x4bb900(0x135))/0x7*(-parseInt(_0x4bb900(0x129))/0x8)+parseInt(_0x4bb900(0x14a))/0x9;if(_0x7d1e1d===_0x26fc8a)break;else _0x18de53['push'](_0x18de53['shift']());}catch(_0x248f63){_0x18de53['push'](_0x18de53['shift']());}}}(_0x4b78,0x38ae6));function _0x3b78(_0x51fa8e,_0x5f0829){const _0x4b789a=_0x4b78();return _0x3b78=function(_0x3b7880,_0x93264){_0x3b7880=_0x3b7880-0x125;let _0x38b181=_0x4b789a[_0x3b7880];return _0x38b181;},_0x3b78(_0x51fa8e,_0x5f0829);}var __decorate=this&&this[_0x16c536(0x130)]||function(_0x49d0db,_0x3e79aa,_0x3e332e,_0x30679a){const _0x5d7a45=_0x16c536;var _0x1e9ae5=arguments[_0x5d7a45(0x13c)],_0x5b8d1a=_0x1e9ae5<0x3?_0x3e79aa:_0x30679a===null?_0x30679a=Object[_0x5d7a45(0x152)](_0x3e79aa,_0x3e332e):_0x30679a,_0x4611da;if(typeof Reflect===_0x5d7a45(0x12b)&&typeof Reflect[_0x5d7a45(0x139)]===_0x5d7a45(0x144))_0x5b8d1a=Reflect[_0x5d7a45(0x139)](_0x49d0db,_0x3e79aa,_0x3e332e,_0x30679a);else{for(var _0x4a84c3=_0x49d0db['length']-0x1;_0x4a84c3>=0x0;_0x4a84c3--)if(_0x4611da=_0x49d0db[_0x4a84c3])_0x5b8d1a=(_0x1e9ae5<0x3?_0x4611da(_0x5b8d1a):_0x1e9ae5>0x3?_0x4611da(_0x3e79aa,_0x3e332e,_0x5b8d1a):_0x4611da(_0x3e79aa,_0x3e332e))||_0x5b8d1a;}return _0x1e9ae5>0x3&&_0x5b8d1a&&Object[_0x5d7a45(0x131)](_0x3e79aa,_0x3e332e,_0x5b8d1a),_0x5b8d1a;},__metadata=this&&this[_0x16c536(0x127)]||function(_0x55d454,_0x1fdb98){const _0x1589cc=_0x16c536;if(typeof Reflect==='object'&&typeof Reflect[_0x1589cc(0x14b)]==='function')return Reflect['metadata'](_0x55d454,_0x1fdb98);},__param=this&&this[_0x16c536(0x149)]||function(_0x18b4dd,_0x9db39f){return function(_0x564445,_0x3be190){_0x9db39f(_0x564445,_0x3be190,_0x18b4dd);};};Object['defineProperty'](exports,_0x16c536(0x14f),{'value':!![]}),exports[_0x16c536(0x142)]=void 0x0;const common_1=require(_0x16c536(0x14d));let RedisCacheService=class RedisCacheService{constructor(_0x3c70ed){this['redisClient']=_0x3c70ed;}async[_0x16c536(0x126)](){}[_0x16c536(0x140)](){const _0x5cd2ad=_0x16c536;return this[_0x5cd2ad(0x12f)][_0x5cd2ad(0x128)]('aaa',0x6f),0x1;}async[_0x16c536(0x138)](_0x152b78){const _0x3ae1b4=_0x16c536,{key:_0x2fd440}=_0x152b78,_0x1921c9=await this[_0x3ae1b4(0x12f)][_0x3ae1b4(0x138)](_0x2fd440);return await this[_0x3ae1b4(0x12f)][_0x3ae1b4(0x138)](_0x2fd440);}async[_0x16c536(0x128)](_0x56d90c,_0x52883a){const _0x3011b0=_0x16c536;try{const {key:_0x102b9e,val:_0x3a89cb}=_0x56d90c;await this[_0x3011b0(0x12f)][_0x3011b0(0x128)](_0x102b9e,_0x3a89cb),_0x52883a&&await this[_0x3011b0(0x12f)][_0x3011b0(0x150)](_0x102b9e,_0x52883a);return;}catch(_0x5b6587){throw new common_1[(_0x3011b0(0x141))](_0x5b6587,common_1['HttpStatus']['BAD_REQUEST']);}}async[_0x16c536(0x14e)](_0x4e49da){const _0x290078=_0x16c536;return await this[_0x290078(0x12f)][_0x290078(0x14e)](_0x4e49da);}async[_0x16c536(0x13f)](_0x4b4024){const _0x165d0d=_0x16c536,{key:_0x4c0fe2}=_0x4b4024;await this[_0x165d0d(0x12f)][_0x165d0d(0x13f)](_0x4c0fe2);return;}async[_0x16c536(0x133)](_0x1680f0,_0x47f3af){const _0x337c84=_0x16c536,_0x466662=await this['redisClient'][_0x337c84(0x145)](_0x337c84(0x12d)+_0x1680f0,0x0,-0x1);await this['invalidateTokens'](_0x1680f0,_0x466662),this['redisClient'][_0x337c84(0x128)]('token:'+_0x1680f0,_0x47f3af);}async[_0x16c536(0x13b)](_0x3a02f3,_0x283376){const _0x390961=_0x16c536;_0x283376[_0x390961(0x143)](_0x43ec7d=>{const _0x3e5540=_0x390961;this['redisClient'][_0x3e5540(0x13f)]('token:'+_0x3a02f3+':'+_0x43ec7d);});}async[_0x16c536(0x125)](_0xd46be5,_0x31f104,_0x3e464d){const _0x4dc317=_0x16c536,_0x1dd2d3=await this[_0x4dc317(0x12f)][_0x4dc317(0x138)](_0x4dc317(0x132)+_0x31f104);if(_0x1dd2d3===null)return await this[_0x4dc317(0x12f)][_0x4dc317(0x128)](_0x4dc317(0x132)+_0x31f104,_0xd46be5),!![];if(_0x1dd2d3!==_0xd46be5){if([_0x4dc317(0x148),_0x4dc317(0x146)]['includes'](_0x3e464d))return!![];throw new common_1[(_0x4dc317(0x141))](_0x4dc317(0x14c),common_1[_0x4dc317(0x137)][_0x4dc317(0x136)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x16c536(0x13a)])(),__param(0x0,(0x0,common_1[_0x16c536(0x13e)])('REDIS_CLIENT')),__metadata(_0x16c536(0x134),[Object])],RedisCacheService),exports[_0x16c536(0x142)]=RedisCacheService;