'use strict';const _0x49d285=_0x2f8d;(function(_0x5d480a,_0x120e78){const _0x15d5f4=_0x2f8d,_0x3829c3=_0x5d480a();while(!![]){try{const _0x19bdf4=-parseInt(_0x15d5f4(0x17a))/0x1*(parseInt(_0x15d5f4(0x16b))/0x2)+parseInt(_0x15d5f4(0x153))/0x3+-parseInt(_0x15d5f4(0x17c))/0x4*(parseInt(_0x15d5f4(0x164))/0x5)+parseInt(_0x15d5f4(0x17e))/0x6*(parseInt(_0x15d5f4(0x16f))/0x7)+-parseInt(_0x15d5f4(0x162))/0x8+parseInt(_0x15d5f4(0x160))/0x9*(-parseInt(_0x15d5f4(0x151))/0xa)+parseInt(_0x15d5f4(0x16a))/0xb*(parseInt(_0x15d5f4(0x14e))/0xc);if(_0x19bdf4===_0x120e78)break;else _0x3829c3['push'](_0x3829c3['shift']());}catch(_0x971e04){_0x3829c3['push'](_0x3829c3['shift']());}}}(_0x1c33,0xcc1f2));function _0x2f8d(_0x3ffe86,_0x5e2d31){const _0x1c3348=_0x1c33();return _0x2f8d=function(_0x2f8d14,_0x4991ad){_0x2f8d14=_0x2f8d14-0x14c;let _0x308b8b=_0x1c3348[_0x2f8d14];return _0x308b8b;},_0x2f8d(_0x3ffe86,_0x5e2d31);}var __decorate=this&&this[_0x49d285(0x172)]||function(_0x57bef3,_0x1596e7,_0x3e37a7,_0x1434ca){const _0x1fbf7c=_0x49d285;var _0xacbefc=arguments[_0x1fbf7c(0x188)],_0x218f9e=_0xacbefc<0x3?_0x1596e7:_0x1434ca===null?_0x1434ca=Object[_0x1fbf7c(0x170)](_0x1596e7,_0x3e37a7):_0x1434ca,_0x484eac;if(typeof Reflect===_0x1fbf7c(0x150)&&typeof Reflect[_0x1fbf7c(0x171)]===_0x1fbf7c(0x17f))_0x218f9e=Reflect[_0x1fbf7c(0x171)](_0x57bef3,_0x1596e7,_0x3e37a7,_0x1434ca);else{for(var _0x295e4e=_0x57bef3[_0x1fbf7c(0x188)]-0x1;_0x295e4e>=0x0;_0x295e4e--)if(_0x484eac=_0x57bef3[_0x295e4e])_0x218f9e=(_0xacbefc<0x3?_0x484eac(_0x218f9e):_0xacbefc>0x3?_0x484eac(_0x1596e7,_0x3e37a7,_0x218f9e):_0x484eac(_0x1596e7,_0x3e37a7))||_0x218f9e;}return _0xacbefc>0x3&&_0x218f9e&&Object[_0x1fbf7c(0x15a)](_0x1596e7,_0x3e37a7,_0x218f9e),_0x218f9e;},__metadata=this&&this[_0x49d285(0x154)]||function(_0x4e9d1c,_0x1775ca){const _0x11da19=_0x49d285;if(typeof Reflect===_0x11da19(0x150)&&typeof Reflect[_0x11da19(0x186)]==='function')return Reflect[_0x11da19(0x186)](_0x4e9d1c,_0x1775ca);},__param=this&&this['__param']||function(_0x2fc857,_0x57b283){return function(_0x464d6a,_0x50f0fa){_0x57b283(_0x464d6a,_0x50f0fa,_0x2fc857);};};function _0x1c33(){const _0x1249ad=['删除成功','非法操作、您在删除一个非法资源！','update','metadata','非法操作、您在使用一个未启用的应用！','length','find','@nestjs/typeorm','84BrKiKT','Repository','object','5554870Xsukov','appEntity','4932381uuumCU','__metadata','新对话','DESC','非法操作、您在修改一个非法资源！','del','HttpStatus','defineProperty','当前应用已经开启了一个对话无需新建了！','findOne','ChatGroupService','isSticky','title','27mkWvrA','affected','8426048uhODKd','chatGroupEntity','428105GsxTtz','更新对话失败！','删除失败！','typeorm','query','HttpException','4345605mTHOpe','2911274kgXxeZ','count','./chatGroup.entity','delAll','79233TpoaHy','getOwnPropertyDescriptor','decorate','__decorate','../app/app.entity','design:paramtypes','__esModule','BAD_REQUEST','save','Injectable','ChatGroupEntity','1UUycaX','AppEntity','20ZOrRhI','appId','546kdpzdl','function','includes','user','@nestjs/common'];_0x1c33=function(){return _0x1249ad;};return _0x1c33();}Object['defineProperty'](exports,_0x49d285(0x175),{'value':!![]}),exports[_0x49d285(0x15d)]=void 0x0;const common_1=require(_0x49d285(0x182)),chatGroup_entity_1=require(_0x49d285(0x16d)),typeorm_1=require(_0x49d285(0x14d)),typeorm_2=require(_0x49d285(0x167)),app_entity_1=require(_0x49d285(0x173));let ChatGroupService=class ChatGroupService{constructor(_0x1f67db,_0xf51a69){const _0x38c55a=_0x49d285;this[_0x38c55a(0x163)]=_0x1f67db,this[_0x38c55a(0x152)]=_0xf51a69;}async['create'](_0x34977a,_0x4dd5dc){const _0x52d48f=_0x49d285,{id:_0x452f81}=_0x4dd5dc[_0x52d48f(0x181)],{appId:_0xe8b4a4}=_0x34977a,_0x36f4d5={'title':_0x52d48f(0x155),'userId':_0x452f81};if(_0xe8b4a4){const _0x896d65=await this['appEntity'][_0x52d48f(0x15c)]({'where':{'id':_0xe8b4a4}});if(!_0x896d65)throw new common_1[(_0x52d48f(0x169))]('非法操作、您在使用一个不存在的应用！',common_1['HttpStatus'][_0x52d48f(0x176)]);else{const {status:_0x524323,name:_0x3a033b}=_0x896d65,_0x168718=await this[_0x52d48f(0x163)][_0x52d48f(0x16c)]({'where':{'userId':_0x452f81,'appId':_0xe8b4a4,'isDelete':![]}});if(_0x168718>0x0)throw new common_1[(_0x52d48f(0x169))](_0x52d48f(0x15b),common_1[_0x52d48f(0x159)]['BAD_REQUEST']);if(![0x1,0x3,0x4,0x5][_0x52d48f(0x180)](_0x524323))throw new common_1[(_0x52d48f(0x169))](_0x52d48f(0x187),common_1['HttpStatus']['BAD_REQUEST']);_0x3a033b&&(_0x36f4d5[_0x52d48f(0x15f)]=_0x3a033b),_0xe8b4a4&&(_0x36f4d5[_0x52d48f(0x17d)]=_0xe8b4a4);}}return await this[_0x52d48f(0x163)][_0x52d48f(0x177)](_0x36f4d5);}async[_0x49d285(0x168)](_0x47c2a8){const _0x4055df=_0x49d285,{id:_0x11f28e}=_0x47c2a8['user'],_0x594f39={'userId':_0x11f28e,'isDelete':![]};return await this['chatGroupEntity'][_0x4055df(0x14c)]({'where':_0x594f39,'order':{'isSticky':_0x4055df(0x156),'id':'DESC'}});}async[_0x49d285(0x185)](_0x3daf2b,_0x2d6891){const _0x456d1e=_0x49d285,{title:_0x49215b,isSticky:_0x394f13,groupId:_0x1b3ac2}=_0x3daf2b,{id:_0x31a803}=_0x2d6891[_0x456d1e(0x181)],_0x251f11=await this['chatGroupEntity']['findOne']({'where':{'id':_0x1b3ac2,'userId':_0x31a803}});if(!_0x251f11)throw new common_1[(_0x456d1e(0x169))](_0x456d1e(0x157),common_1[_0x456d1e(0x159)][_0x456d1e(0x176)]);const {appId:_0x2c0908}=_0x251f11;if(_0x2c0908)throw new common_1['HttpException']('应用对话名称不能修改哟！',common_1[_0x456d1e(0x159)][_0x456d1e(0x176)]);const _0x341a44={};_0x49215b&&(_0x341a44['title']=_0x49215b),typeof _0x394f13!=='undefined'&&(_0x341a44[_0x456d1e(0x15e)]=_0x394f13);const _0x43bb34=await this['chatGroupEntity'][_0x456d1e(0x185)]({'id':_0x1b3ac2},_0x341a44);if(_0x43bb34[_0x456d1e(0x161)])return!![];else throw new common_1[(_0x456d1e(0x169))](_0x456d1e(0x165),common_1[_0x456d1e(0x159)][_0x456d1e(0x176)]);}async[_0x49d285(0x158)](_0x6d81df,_0x5e6852){const _0x40464a=_0x49d285,{groupId:_0x2787c9}=_0x6d81df,{id:_0x29634c}=_0x5e6852[_0x40464a(0x181)],_0x2fe9a9=await this[_0x40464a(0x163)]['findOne']({'where':{'id':_0x2787c9,'userId':_0x29634c}});if(!_0x2fe9a9)throw new common_1[(_0x40464a(0x169))](_0x40464a(0x184),common_1[_0x40464a(0x159)][_0x40464a(0x176)]);const _0x2ea312=await this[_0x40464a(0x163)]['update']({'id':_0x2787c9},{'isDelete':!![]});if(_0x2ea312[_0x40464a(0x161)])return _0x40464a(0x183);else throw new common_1[(_0x40464a(0x169))](_0x40464a(0x166),common_1['HttpStatus'][_0x40464a(0x176)]);}async[_0x49d285(0x16e)](_0x233c2a){const _0xa487b8=_0x49d285,{id:_0x218424}=_0x233c2a['user'],_0xb5af6a=await this[_0xa487b8(0x163)][_0xa487b8(0x185)]({'userId':_0x218424,'isSticky':![],'isDelete':![]},{'isDelete':!![]});if(_0xb5af6a[_0xa487b8(0x161)])return'删除成功';else throw new common_1[(_0xa487b8(0x169))](_0xa487b8(0x166),common_1[_0xa487b8(0x159)][_0xa487b8(0x176)]);}};ChatGroupService=__decorate([(0x0,common_1[_0x49d285(0x178)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(chatGroup_entity_1[_0x49d285(0x179)])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(app_entity_1[_0x49d285(0x17b)])),__metadata(_0x49d285(0x174),[typeorm_2[_0x49d285(0x14f)],typeorm_2[_0x49d285(0x14f)]])],ChatGroupService),exports['ChatGroupService']=ChatGroupService;