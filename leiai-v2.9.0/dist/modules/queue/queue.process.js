'use strict';function _0x3fbb(_0x5b185d,_0x109a15){var _0x39d0ed=_0x39d0();return _0x3fbb=function(_0x3fbb99,_0x4a9a14){_0x3fbb99=_0x3fbb99-0x188;var _0x163d34=_0x39d0ed[_0x3fbb99];return _0x163d34;},_0x3fbb(_0x5b185d,_0x109a15);}var _0x348910=_0x3fbb;(function(_0x18fe7f,_0x3180cd){var _0x452b56=_0x3fbb,_0x4d754c=_0x18fe7f();while(!![]){try{var _0x339351=-parseInt(_0x452b56(0x196))/0x1+-parseInt(_0x452b56(0x1bd))/0x2+-parseInt(_0x452b56(0x1a3))/0x3+parseInt(_0x452b56(0x1b4))/0x4+-parseInt(_0x452b56(0x1b8))/0x5+-parseInt(_0x452b56(0x1a4))/0x6*(parseInt(_0x452b56(0x19f))/0x7)+parseInt(_0x452b56(0x1b0))/0x8;if(_0x339351===_0x3180cd)break;else _0x4d754c['push'](_0x4d754c['shift']());}catch(_0x40cd12){_0x4d754c['push'](_0x4d754c['shift']());}}}(_0x39d0,0x97f12));function _0x39d0(){var _0x2cf816=['onQueueResumed','OnQueueError','\x20were\x20cleaned.','QueueProcessor','onQueuePaused','data','prototype','MidjourneyService','midjourneyService','Process','design:returntype','OnQueueResumed','队列任务的一个回调用于通知当前进度','env','队列恢复的时候调用','defineProperty','decorate','name','队列发生错误','1077306SDzTGS','mjDraw','log','function','Queue\x20failed:\x20','drawFailed',':\x20绘画失败\x20','OnQueuePaused','OnQueueCompleted','7IXLyYc','../midjourney/midjourney.service','onQueueError','length','2980257TQZxos','4091742pLbmMf','onQueueCleaned','handleJob','error','Processor','OnQueueCleaned','onQueueProgress','onQueueFailed','Logger','onQueueActive','\x20jobs\x20of\x20type\x20','design:paramtypes','31513592eRSxAO','metadata','object','MJDRAW','3596588rHPhUh','design:type','OnQueueFailed','OnQueueProgress','2594725PvvmvC','logger','onQueueCompleted','@nestjs/bull','draw','1888730qodZWS','onQueueDrained'];_0x39d0=function(){return _0x2cf816;};return _0x39d0();}var __decorate=this&&this['__decorate']||function(_0x441fb0,_0x2f1987,_0x5deed8,_0x1e5584){var _0x1d51e5=_0x3fbb,_0x4cd58f=arguments[_0x1d51e5(0x1a2)],_0x2e6272=_0x4cd58f<0x3?_0x2f1987:_0x1e5584===null?_0x1e5584=Object['getOwnPropertyDescriptor'](_0x2f1987,_0x5deed8):_0x1e5584,_0x25fe45;if(typeof Reflect===_0x1d51e5(0x1b2)&&typeof Reflect[_0x1d51e5(0x193)]===_0x1d51e5(0x199))_0x2e6272=Reflect[_0x1d51e5(0x193)](_0x441fb0,_0x2f1987,_0x5deed8,_0x1e5584);else{for(var _0x17fbfc=_0x441fb0[_0x1d51e5(0x1a2)]-0x1;_0x17fbfc>=0x0;_0x17fbfc--)if(_0x25fe45=_0x441fb0[_0x17fbfc])_0x2e6272=(_0x4cd58f<0x3?_0x25fe45(_0x2e6272):_0x4cd58f>0x3?_0x25fe45(_0x2f1987,_0x5deed8,_0x2e6272):_0x25fe45(_0x2f1987,_0x5deed8))||_0x2e6272;}return _0x4cd58f>0x3&&_0x2e6272&&Object[_0x1d51e5(0x192)](_0x2f1987,_0x5deed8,_0x2e6272),_0x2e6272;},__metadata=this&&this['__metadata']||function(_0x5daabb,_0x172615){var _0x3dd045=_0x3fbb;if(typeof Reflect==='object'&&typeof Reflect[_0x3dd045(0x1b1)]==='function')return Reflect[_0x3dd045(0x1b1)](_0x5daabb,_0x172615);},QueueProcessor_1;Object[_0x348910(0x192)](exports,'__esModule',{'value':!![]}),exports['QueueProcessor']=void 0x0;const bull_1=require(_0x348910(0x1bb)),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x348910(0x1a0));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x2bc6f5){var _0x23fc81=_0x348910;this[_0x23fc81(0x18b)]=_0x2bc6f5,this[_0x23fc81(0x1b9)]=new common_1[(_0x23fc81(0x1ac))](QueueProcessor_1[_0x23fc81(0x194)]);}async[_0x348910(0x1a6)](_0x12f3cd){var _0x564c0a=_0x348910;const _0x5f4631=await this['midjourneyService'][_0x564c0a(0x1bc)](_0x12f3cd[_0x564c0a(0x188)],_0x12f3cd['id']);return _0x5f4631;}[_0x348910(0x1ad)](_0x40a72b){}[_0x348910(0x1a1)](_0x2ec125){var _0x9c927=_0x348910;console['log'](_0x9c927(0x195),_0x2ec125);}['onQueueProgress'](_0x5c1810,_0x22dc1c){var _0x46cdfb=_0x348910;console['log'](_0x46cdfb(0x18f),_0x5c1810['id'],_0x22dc1c);}[_0x348910(0x1ba)](_0x3ec201,_0x134f65){}[_0x348910(0x1ab)](_0x213b7f,_0x540b7b){var _0x2d8011=_0x348910;common_1['Logger'][_0x2d8011(0x1a7)](_0x2d8011(0x19a)+_0x540b7b['message']+_0x2d8011(0x19c)+_0x213b7f['id'],_0x2d8011(0x1c2)),this[_0x2d8011(0x18b)][_0x2d8011(0x19b)](_0x213b7f[_0x2d8011(0x188)]);}[_0x348910(0x1c3)](){console['log']('队列暂停的时候调用');}[_0x348910(0x1bf)](){var _0x160ac5=_0x348910;console['log'](_0x160ac5(0x191));}[_0x348910(0x1a5)](_0x353052,_0x202717){var _0x52b240=_0x348910;common_1['Logger'][_0x52b240(0x198)]('Queue\x20cleaned:\x20'+_0x353052[_0x52b240(0x1a2)]+_0x52b240(0x1ae)+_0x202717+_0x52b240(0x1c1),_0x52b240(0x1c2));}['onQueueDrained'](){}};__decorate([(0x0,bull_1[_0x348910(0x18c)])({'name':_0x348910(0x197),'concurrency':process[_0x348910(0x190)]['CONCURRENCY']?+process['env']['CONCURRENCY']:0x3}),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Object]),__metadata(_0x348910(0x18d),Promise)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1a6),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Object]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1ad),null),__decorate([(0x0,bull_1[_0x348910(0x1c0)])(),__metadata('design:type',Function),__metadata(_0x348910(0x1af),[Error]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],'onQueueError',null),__decorate([(0x0,bull_1[_0x348910(0x1b7)])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Object,Number]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1aa),null),__decorate([(0x0,bull_1[_0x348910(0x19e)])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Object,Object]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor['prototype'],_0x348910(0x1ba),null),__decorate([(0x0,bull_1[_0x348910(0x1b6)])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Object,Error]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor['prototype'],_0x348910(0x1ab),null),__decorate([(0x0,bull_1[_0x348910(0x19d)])(),__metadata('design:type',Function),__metadata(_0x348910(0x1af),[]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1c3),null),__decorate([(0x0,bull_1[_0x348910(0x18e)])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1bf),null),__decorate([(0x0,bull_1[_0x348910(0x1a9)])(),__metadata(_0x348910(0x1b5),Function),__metadata(_0x348910(0x1af),[Array,String]),__metadata(_0x348910(0x18d),void 0x0)],QueueProcessor[_0x348910(0x189)],_0x348910(0x1a5),null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata('design:type',Function),__metadata(_0x348910(0x1af),[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x348910(0x1be),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x348910(0x1a8)])(_0x348910(0x1b3)),__metadata(_0x348910(0x1af),[midjourney_service_1[_0x348910(0x18a)]])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;